{"ast":null,"code":"import '@safe-global/safe-apps-provider';\nimport '@safe-global/safe-apps-sdk';\nimport { ProviderNotFoundError, createConnector } from '@wagmi/core';\nimport { getAddress } from 'viem';\nsafe.type = 'safe';\nexport function safe(parameters = {}) {\n  const {\n    shimDisconnect = false\n  } = parameters;\n  let provider_;\n  let disconnect;\n  return createConnector(config => ({\n    id: 'safe',\n    name: 'Safe',\n    type: safe.type,\n    async connect() {\n      const provider = await this.getProvider();\n      if (!provider) throw new ProviderNotFoundError();\n      const accounts = await this.getAccounts();\n      const chainId = await this.getChainId();\n      if (!disconnect) {\n        disconnect = this.onDisconnect.bind(this);\n        provider.on('disconnect', disconnect);\n      }\n      // Remove disconnected shim if it exists\n      if (shimDisconnect) await config.storage?.removeItem('safe.disconnected');\n      return {\n        accounts,\n        chainId\n      };\n    },\n    async disconnect() {\n      const provider = await this.getProvider();\n      if (!provider) throw new ProviderNotFoundError();\n      if (disconnect) {\n        provider.removeListener('disconnect', disconnect);\n        disconnect = undefined;\n      }\n      // Add shim signalling connector is disconnected\n      if (shimDisconnect) await config.storage?.setItem('safe.disconnected', true);\n    },\n    async getAccounts() {\n      const provider = await this.getProvider();\n      if (!provider) throw new ProviderNotFoundError();\n      return (await provider.request({\n        method: 'eth_accounts'\n      })).map(getAddress);\n    },\n    async getProvider() {\n      // Only allowed in iframe context\n      const isIframe = typeof window !== 'undefined' && window?.parent !== window;\n      if (!isIframe) return;\n      if (!provider_) {\n        const {\n          default: SafeAppsSDK\n        } = await import('@safe-global/safe-apps-sdk');\n        let SDK;\n        if (typeof SafeAppsSDK !== 'function' && typeof SafeAppsSDK.default === 'function') SDK = SafeAppsSDK.default;else SDK = SafeAppsSDK;\n        const sdk = new SDK(parameters);\n        const safe = await sdk.safe.getInfo();\n        if (!safe) throw new Error('Could not load Safe information');\n        const {\n          SafeAppProvider\n        } = await import('@safe-global/safe-apps-provider');\n        provider_ = new SafeAppProvider(safe, sdk);\n      }\n      return provider_;\n    },\n    async getChainId() {\n      const provider = await this.getProvider();\n      if (!provider) throw new ProviderNotFoundError();\n      return Number(provider.chainId);\n    },\n    async isAuthorized() {\n      try {\n        const isDisconnected = shimDisconnect && (\n        // If shim exists in storage, connector is disconnected\n        await config.storage?.getItem('safe.disconnected'));\n        if (isDisconnected) return false;\n        const accounts = await this.getAccounts();\n        return !!accounts.length;\n      } catch {\n        return false;\n      }\n    },\n    onAccountsChanged() {\n      // Not relevant for Safe because changing account requires app reload.\n    },\n    onChainChanged() {\n      // Not relevant for Safe because Safe smart contract wallets only exist on single chain.\n    },\n    onDisconnect() {\n      config.emitter.emit('disconnect');\n    }\n  }));\n}","map":{"version":3,"names":["ProviderNotFoundError","createConnector","getAddress","safe","type","parameters","shimDisconnect","provider_","disconnect","config","id","name","connect","provider","getProvider","accounts","getAccounts","chainId","getChainId","onDisconnect","bind","on","storage","removeItem","removeListener","undefined","setItem","request","method","map","isIframe","window","parent","default","SafeAppsSDK","SDK","sdk","getInfo","Error","SafeAppProvider","Number","isAuthorized","isDisconnected","getItem","length","onAccountsChanged","onChainChanged","emitter","emit"],"sources":["/Users/nikhilbhatia/NIkhil/ZT-Prejects/wagmi-react-app/node_modules/wagmi/node_modules/@wagmi/connectors/src/safe.ts"],"sourcesContent":["import { type SafeAppProvider } from '@safe-global/safe-apps-provider'\nimport { type Opts } from '@safe-global/safe-apps-sdk'\nimport {\n  type Connector,\n  ProviderNotFoundError,\n  createConnector,\n} from '@wagmi/core'\nimport type { Evaluate } from '@wagmi/core/internal'\nimport { getAddress } from 'viem'\n\nexport type SafeParameters = Evaluate<\n  Opts & {\n    /**\n     * Connector automatically connects when used as Safe App.\n     *\n     * This flag simulates the disconnect behavior by keeping track of connection status in storage\n     * and only autoconnecting when previously connected by user action (e.g. explicitly choosing to connect).\n     *\n     * @default false\n     */\n    shimDisconnect?: boolean | undefined\n  }\n>\n\nsafe.type = 'safe' as const\nexport function safe(parameters: SafeParameters = {}) {\n  const { shimDisconnect = false } = parameters\n\n  type Provider = SafeAppProvider | undefined\n  type Properties = {}\n  type StorageItem = { 'safe.disconnected': true }\n\n  let provider_: Provider | undefined\n\n  let disconnect: Connector['onDisconnect'] | undefined\n\n  return createConnector<Provider, Properties, StorageItem>((config) => ({\n    id: 'safe',\n    name: 'Safe',\n    type: safe.type,\n    async connect() {\n      const provider = await this.getProvider()\n      if (!provider) throw new ProviderNotFoundError()\n\n      const accounts = await this.getAccounts()\n      const chainId = await this.getChainId()\n\n      if (!disconnect) {\n        disconnect = this.onDisconnect.bind(this)\n        provider.on('disconnect', disconnect)\n      }\n\n      // Remove disconnected shim if it exists\n      if (shimDisconnect) await config.storage?.removeItem('safe.disconnected')\n\n      return { accounts, chainId }\n    },\n    async disconnect() {\n      const provider = await this.getProvider()\n      if (!provider) throw new ProviderNotFoundError()\n\n      if (disconnect) {\n        provider.removeListener('disconnect', disconnect)\n        disconnect = undefined\n      }\n\n      // Add shim signalling connector is disconnected\n      if (shimDisconnect)\n        await config.storage?.setItem('safe.disconnected', true)\n    },\n    async getAccounts() {\n      const provider = await this.getProvider()\n      if (!provider) throw new ProviderNotFoundError()\n      return (await provider.request({ method: 'eth_accounts' })).map(\n        getAddress,\n      )\n    },\n    async getProvider() {\n      // Only allowed in iframe context\n      const isIframe =\n        typeof window !== 'undefined' && window?.parent !== window\n      if (!isIframe) return\n\n      if (!provider_) {\n        const { default: SafeAppsSDK } = await import(\n          '@safe-global/safe-apps-sdk'\n        )\n        let SDK: typeof SafeAppsSDK.default\n        if (\n          typeof SafeAppsSDK !== 'function' &&\n          typeof SafeAppsSDK.default === 'function'\n        )\n          SDK = SafeAppsSDK.default\n        else SDK = SafeAppsSDK as unknown as typeof SafeAppsSDK.default\n        const sdk = new SDK(parameters)\n\n        const safe = await sdk.safe.getInfo()\n        if (!safe) throw new Error('Could not load Safe information')\n        const { SafeAppProvider } = await import(\n          '@safe-global/safe-apps-provider'\n        )\n        provider_ = new SafeAppProvider(safe, sdk)\n      }\n      return provider_\n    },\n    async getChainId() {\n      const provider = await this.getProvider()\n      if (!provider) throw new ProviderNotFoundError()\n      return Number(provider.chainId)\n    },\n    async isAuthorized() {\n      try {\n        const isDisconnected =\n          shimDisconnect &&\n          // If shim exists in storage, connector is disconnected\n          (await config.storage?.getItem('safe.disconnected'))\n        if (isDisconnected) return false\n\n        const accounts = await this.getAccounts()\n        return !!accounts.length\n      } catch {\n        return false\n      }\n    },\n    onAccountsChanged() {\n      // Not relevant for Safe because changing account requires app reload.\n    },\n    onChainChanged() {\n      // Not relevant for Safe because Safe smart contract wallets only exist on single chain.\n    },\n    onDisconnect() {\n      config.emitter.emit('disconnect')\n    },\n  }))\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}